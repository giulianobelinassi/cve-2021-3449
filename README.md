# SUSE Userspace Livepatch Demo

This is a userspace livepatch demo using **libpulp**, by SUSE.

# The CVE-2021-3449 OpenSSL <1.1.1k DoS exploit

This is a exploit in OpenSSL <1.1.1k exploit that allows an attacker to perform
a DoS attack by manipulating a "secure renegotiation", causing libssl to crash
on the server side.

On SUSE side, this exploit was fixed in OpenSSL 1.1.1d during a SLE-12 update.
Newer versions of SLE were unaffected.

## Reproducing the CVE

1. Install [libpulp](https://github.com/SUSE/libpulp).
2. Compile `libcve-2021-3449_livepatch1.so` by running `make` in the `livepatch` folder.
3. Compile `cve-2021-3449` by running `make` in the root folder.
4. Run `s_server` in `openssl-1.1.1d` folder.
5. Run `./cve-2021-3449 -host 127.0.0.1:44330` to ensure that `s_server` is vunerable by receiving a `SIGSEGFAULT`.
6. Run `s_server` again to restart the server.
7. Run `ulp trigger -p $(pidof openssl) cve-2021-3449.ulp` to patch `s_server`
8. Run `./cve-2021-3449 -host 127.0.0.1:44330` to ensure that the patch was fixed.

## References

- [CVE-2021-3449 OpenSSL <1.1.1k DoS exploit](https://github.com/terorie/cve-2021-3449)
- [OpenSSL security advisory](https://www.openssl.org/news/secadv/20210325.txt)
- [cve.mitre.org](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3449)
- [Ubuntu security notice](https://ubuntu.com/security/notices/USN-4891-1) (USN-4891-1)
- [Debian security tracker](https://security-tracker.debian.org/tracker/CVE-2021-3449)
- [Red Hat CVE entry](https://access.redhat.com/security/cve/CVE-2021-3449)

> This issue was reported to OpenSSL on 17th March 2021 by Nokia. The fix was
> developed by Peter KÃ¤stle and Samuel Sapalski from Nokia.

## Copyright

Original repository by Richard Patel, Glenn Strauss, and Ben Chang: https://github.com/terorie/cve-2021-3449.

This repository bundles the `encoding/tls` package of the Go programming language.

```
// Copyright 2009 The Go Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
```

This also include code from OpenSSL.

```
 * Copyright 1995-2019 The OpenSSL Project Authors. All Rights Reserved.
 * Copyright (c) 2002, Oracle and/or its affiliates. All rights reserved
 * Copyright 2005 Nokia. All rights reserved.
 *
 * Licensed under the OpenSSL license (the "License").  You may not use
 * this file except in compliance with the License.  You can obtain a copy
 * in the file LICENSE in the source distribution or at
 * https://www.openssl.org/source/license.html
```
